<app-spinner [visible]="isDashboardLoading"></app-spinner>

@if(role=="customer"){
  @if(upcomingBookings.length>0){
  <app-upcoming-bookings-row 
    title="Upcoming Bookings"
    [bookings]="upcomingBookings"
    [defaultImage]="defaultImage"
    (bookingClick)="onBookingClick($event)" 
    >
  </app-upcoming-bookings-row>
  }
  @else {
    <div class="empty-state">
      <i class="pi pi-calendar-times"></i>
      <h3>No Upcoming Bookings</h3>
      <p>Browse events nearby to plan your next outing.</p>
    </div>
  }
}

<app-upcoming-booking-details
  [(visible)]="bookingDialogVisible"
  [booking]="selectedBooking">
</app-upcoming-booking-details>

<div class="events-header">
  <h2 class="events-title">{{ role === 'admin' ? 'Unblocked Events Near You' : 'Events Near You' }}</h2>

  <button
    *ngIf="role === 'admin'||role==='host'"
    pButton
    icon="pi pi-plus"
    class="add-btn"
    (click)="addEventDialog.open()">
  </button>
</div>

@if(events.length>0){
<app-events-row 
  [events]="events"
  [defaultImage]="defaultImage"
  (eventClick)="goToEventDetails($event)">
</app-events-row>
}
@else {
  <div class="empty-state">
    <i class="pi pi-calendar"></i>
    <h3>No Events Nearby</h3>
    <p>Try another location or check back soon for new events.</p>
  </div>
}

@if (role=="admin"){
  <h2 class="events-title">Blocked Events</h2>

  @if(blockedEvents.length>0){
  <app-events-row 
    [events]="blockedEvents"
    [defaultImage]="defaultImage"
    (eventClick)="goToEventDetails($event)">
  </app-events-row>
  }
  @else {
    <div class="empty-state">
      <i class="pi pi-lock"></i>
      <h3>No Blocked Events</h3>
      <p>All events are currently visible to attendees.</p>
    </div>
  }
}

<app-add-event-dialog
  #addEventDialog
  (eventAdded)="refreshEvents()">
</app-add-event-dialog>

@if (role=="host"){
  <h2 class ="events-title">Events Hosted By You</h2>
  @if(hostedEvents.length>0){
    <app-events-row 
      [events]="hostedEvents"
      [defaultImage]="defaultImage"
      (eventClick)="goToEventDetails($event)">
    </app-events-row>
  }
  @else {
    <div class="empty-state">
      <i class="pi pi-ticket"></i>
      <h3>No Hosted Events</h3>
      <p>Use the add button to create your first event.</p>
    </div>
  }
}
